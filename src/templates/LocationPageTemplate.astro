---
import MainLayout from '../layouts/MainLayout.astro';
import Hero from '../components/ui/Hero.astro';
import Section from '../components/ui/Section.astro';
import Grid from '../components/ui/Grid.astro';
import AstroCard from '../components/ui/AstroCard.astro';
import AstroButton from '../components/ui/AstroButton.astro';
import AstroBadge from '../components/ui/AstroBadge.astro';
import ContentCard from '../components/ui/ContentCard.astro';
import { MapPin, Phone, Clock, Shield, Award, Users, CheckCircle, ArrowRight } from 'lucide-react';

export interface Props {
  // Location Info
  locationName: string;
  locationTitle: string;
  locationSubtitle: string;
  locationDescription: string;
  
  // Hero
  heroBadge?: string;
  heroImage?: string;
  
  // Service Areas
  serviceAreas?: string[];
  
  // Services Offered
  servicesOffered?: Array<{
    title: string;
    description: string;
    url: string;
  }>;
  
  // Local Stats
  localStats?: Array<{
    value: string;
    label: string;
  }>;
  
  // Main content
  mainContent?: string;
}

const {
  locationName,
  locationTitle,
  locationSubtitle,
  locationDescription,
  heroBadge,
  heroImage,
  serviceAreas = [],
  servicesOffered = [],
  localStats = [],
  mainContent
} = Astro.props;

// Default stats if none provided
const defaultStats = [
  { value: "500+", label: "Local Projects" },
  { value: "24/7", label: "Emergency Service" },
  { value: "30 min", label: "Response Time" },
  { value: "100%", label: "Satisfaction" }
];

const stats = localStats.length > 0 ? localStats : defaultStats;
---

<MainLayout title={locationTitle} description={locationDescription}>
  <!-- Hero Section -->
  <Hero
    title={locationName}
    subtitle={locationSubtitle}
    description={locationDescription}
    badge={heroBadge || `Serving ${locationName.split(' ')[0]}`}
    image={heroImage || "/images/toronto-skyline.jpg"}
    imageAlt={`${locationName} waterproofing services`}
    primaryCTA={{ text: "Get Free Quote", href: "/contact/" }}
    secondaryCTA={{ text: "Call Now", href: "tel:437-545-0067" }}
    size="default"
  />
  
  <!-- Local Stats -->
  <Section spacing="small" background="muted">
    <Grid columns={4} gap="small">
      {stats.map((stat) => (
        <div class="text-center">
          <p class="text-3xl font-bold text-primary">{stat.value}</p>
          <p class="text-sm text-muted-foreground mt-1">{stat.label}</p>
        </div>
      ))}
    </Grid>
  </Section>
  
  <!-- Main Content -->
  <Section>
    <div class="max-w-4xl mx-auto">
      <div class="prose prose-lg max-w-none
        prose-headings:font-bold prose-headings:text-foreground
        prose-p:text-foreground prose-p:leading-relaxed
        prose-a:text-primary prose-a:underline-offset-4 hover:prose-a:underline
        prose-strong:text-foreground prose-strong:font-semibold
        prose-ul:list-disc prose-ul:pl-6
        prose-ol:list-decimal prose-ol:pl-6
        prose-img:rounded-lg prose-img:shadow-lg
      ">
        <slot />
      </div>
    </div>
  </Section>
  
  <!-- Service Areas -->
  {serviceAreas.length > 0 && (
    <Section 
      title="Areas We Serve" 
      subtitle="Professional waterproofing services throughout the region"
      background="muted"
      centered
    >
      <div class="max-w-4xl mx-auto">
        <Grid columns={3} gap="small">
          {serviceAreas.map((area) => (
            <div class="flex items-center gap-2 p-3 bg-white rounded-lg shadow-sm">
              <MapPin className="h-5 w-5 text-primary flex-shrink-0" client:load />
              <span class="text-sm font-medium">{area}</span>
            </div>
          ))}
        </Grid>
      </div>
    </Section>
  )}
  
  <!-- Services Offered -->
  <Section
    title="Our Services"
    subtitle={`Professional waterproofing solutions for ${locationName.split(' ')[0]} homeowners`}
  >
    <Grid columns={3}>
      {servicesOffered.map((service) => (
        <AstroCard>
          <h3 class="text-lg font-semibold mb-2">{service.title}</h3>
          <p class="text-muted-foreground text-sm mb-4">{service.description}</p>
          <AstroButton href={service.url} variant="outline" size="sm" class="w-full">
            Learn More
            <ArrowRight className="h-4 w-4 ml-2" client:load />
          </AstroButton>
        </AstroCard>
      ))}
    </Grid>
  </Section>
  
  <!-- Why Choose Local -->
  <Section background="muted">
    <div class="grid md:grid-cols-2 gap-12 items-center">
      <div class="space-y-6">
        <h2 class="text-3xl font-bold">Why Choose Local Experts?</h2>
        <p class="text-lg text-muted-foreground">
          As local waterproofing specialists, we understand the unique challenges 
          faced by homeowners in {locationName.split(' ')[0]}.
        </p>
        
        <div class="space-y-4">
          <div class="flex gap-4">
            <Clock className="h-6 w-6 text-primary flex-shrink-0 mt-1" client:load />
            <div>
              <h3 class="font-semibold mb-1">Fast Response Times</h3>
              <p class="text-muted-foreground text-sm">
                Local team means we can reach you quickly, especially in emergencies
              </p>
            </div>
          </div>
          
          <div class="flex gap-4">
            <Shield className="h-6 w-6 text-primary flex-shrink-0 mt-1" client:load />
            <div>
              <h3 class="font-semibold mb-1">Local Knowledge</h3>
              <p class="text-muted-foreground text-sm">
                We understand local soil conditions, weather patterns, and building codes
              </p>
            </div>
          </div>
          
          <div class="flex gap-4">
            <Users className="h-6 w-6 text-primary flex-shrink-0 mt-1" client:load />
            <div>
              <h3 class="font-semibold mb-1">Community Reputation</h3>
              <p class="text-muted-foreground text-sm">
                Years of serving your neighbors with quality workmanship
              </p>
            </div>
          </div>
        </div>
      </div>
      
      <AstroCard class="bg-gradient-to-br from-primary/5 to-primary/10 border-primary/20">
        <div class="text-center space-y-6">
          <Award className="h-16 w-16 text-primary mx-auto" client:load />
          <h3 class="text-2xl font-bold">Trusted Local Experts</h3>
          <p class="text-muted-foreground">
            Join hundreds of satisfied customers in {locationName.split(' ')[0]} 
            who trust us with their waterproofing needs.
          </p>
          <AstroButton href="/contact/" size="lg" class="gap-2">
            Get Your Free Quote
            <ArrowRight className="h-5 w-5" client:load />
          </AstroButton>
        </div>
      </AstroCard>
    </div>
  </Section>
  
  <!-- Emergency CTA -->
  <Section background="primary" spacing="small">
    <div class="text-center space-y-4">
      <h2 class="text-3xl font-bold text-white">
        Emergency Water Damage in {locationName.split(' ')[0]}?
      </h2>
      <p class="text-white/90 text-lg max-w-2xl mx-auto">
        Don't wait! Our emergency response team is available 24/7 for urgent waterproofing issues.
      </p>
      <div class="flex flex-col sm:flex-row gap-4 justify-center">
        <AstroButton 
          href="tel:437-545-0067" 
          size="lg"
          class="bg-white text-primary hover:bg-gray-100 gap-2"
        >
          <Phone className="h-5 w-5" client:load />
          Call Emergency Line
        </AstroButton>
        <AstroButton 
          href="/emergency/" 
          variant="outline" 
          size="lg"
          class="border-white text-white hover:bg-white/10"
        >
          Emergency Services
        </AstroButton>
      </div>
    </div>
  </Section>
  
  <!-- Final CTA -->
  <Section>
    <AstroCard class="bg-gradient-to-r from-secondary/10 to-secondary/20 border-secondary/30">
      <div class="grid md:grid-cols-2 gap-8 items-center">
        <div class="space-y-4">
          <h2 class="text-3xl font-bold">
            Protect Your {locationName.split(' ')[0]} Home Today
          </h2>
          <p class="text-lg text-muted-foreground">
            Get a free inspection and quote from our local waterproofing experts.
          </p>
          <ul class="space-y-2">
            <li class="flex items-center gap-2">
              <CheckCircle className="h-5 w-5 text-secondary" client:load />
              <span>Free professional inspection</span>
            </li>
            <li class="flex items-center gap-2">
              <CheckCircle className="h-5 w-5 text-secondary" client:load />
              <span>Competitive local pricing</span>
            </li>
            <li class="flex items-center gap-2">
              <CheckCircle className="h-5 w-5 text-secondary" client:load />
              <span>Lifetime warranty protection</span>
            </li>
          </ul>
        </div>
        
        <div class="text-center space-y-4">
          <p class="text-2xl font-bold text-secondary">Ready to get started?</p>
          <AstroButton href="/contact/" size="lg" variant="secondary" class="gap-2">
            Schedule Free Inspection
            <ArrowRight className="h-5 w-5" client:load />
          </AstroButton>
          <p class="text-sm text-muted-foreground">
            Or call us directly at{' '}
            <a href="tel:437-545-0067" class="text-secondary font-semibold">
              (437) 545-0067
            </a>
          </p>
        </div>
      </div>
    </AstroCard>
  </Section>
</MainLayout>