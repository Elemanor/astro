---
import { ScrollAnimation } from './ScrollAnimation';

export interface Feature {
  title: string;
  description: string;
  icon?: string; // SVG path or icon component
  iconType?: 'path' | 'custom'; // 'path' for SVG path, 'custom' for full SVG
  highlight?: boolean; // Highlight this feature
}

export interface Props {
  heading?: string;
  headingAccent?: string;
  subheading?: string;
  features: Feature[];
  columns?: 2 | 3 | 4; // Number of columns on desktop
  variant?: 'default' | 'cards' | 'minimal' | 'centered';
  background?: 'white' | 'gray' | 'primary';
  iconColor?: string; // Tailwind color class
}

const {
  heading,
  headingAccent,
  subheading,
  features,
  columns = 3,
  variant = 'default',
  background = 'white',
  iconColor = 'text-primary'
} = Astro.props;

const backgroundClasses = {
  white: 'bg-white',
  gray: 'bg-gray-50',
  primary: 'bg-primary text-white'
};

const gridClasses = {
  2: 'md:grid-cols-2',
  3: 'md:grid-cols-3',
  4: 'md:grid-cols-2 lg:grid-cols-4'
};

const variantClasses = {
  default: '',
  cards: 'bg-white rounded-lg shadow-lg p-6 hover:shadow-xl transition-all',
  minimal: 'text-center',
  centered: 'text-center'
};

// Default icons if none provided
const defaultIcons = [
  'M9 12l2 2 4-4m5.618-4.016A11.955 11.955 0 0112 2.944a11.955 11.955 0 01-8.618 3.04A12.02 12.02 0 003 9c-1.8 4-2 8 3 9 .5.06 1.026.01 1.588-.05L12 21l4.412-3.05c.562.06 1.088.11 1.588.05 5-1 4.8-5 3-9a12.02 12.02 0 00-.382-2.016z',
  'M12 6V4m0 2a2 2 0 100 4m0-4a2 2 0 110 4m-6 8a2 2 0 100-4m0 4a2 2 0 110-4m0 4v2m0-6V4m6 6v10m6-2a2 2 0 100-4m0 4a2 2 0 110-4m0 4v2m0-6V4',
  'M13 10V3L4 14h7v7l9-11h-7z',
  'M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z'
];
---

<section class={`py-8 sm:py-12 lg:py-24 ${backgroundClasses[background]}`}>
  <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
    {(heading || subheading) && (
      <ScrollAnimation animation="fadeUp" client:visible>
        <div class="text-center mb-8 sm:mb-12 lg:mb-16">
          {subheading && (
            <p class={`text-sm font-medium tracking-wider uppercase mb-4 ${
              background === 'primary' ? 'text-white/80' : 'text-primary'
            }`}>
              {subheading}
            </p>
          )}
          {heading && (
            <h2 class={`font-montserrat text-2xl sm:text-3xl lg:text-4xl xl:text-5xl font-light ${
              background === 'primary' ? 'text-white' : ''
            }`}>
              <span set:html={heading}></span>
              {headingAccent && (
                <>
                  {' '}
                  <span class="font-semibold">{headingAccent}</span>
                </>
              )}
            </h2>
          )}
        </div>
      </ScrollAnimation>
    )}
    
    <div class={`grid grid-cols-1 ${gridClasses[columns]} gap-6 lg:gap-8`}>
      {features.map((feature, index) => (
        <ScrollAnimation 
          animation={variant === 'centered' ? 'zoomIn' : 'fadeUp'} 
          delay={index * 0.1} 
          client:visible
        >
          <div class={`
            ${variant === 'cards' ? variantClasses.cards : ''}
            ${variant === 'minimal' || variant === 'centered' ? 'text-center' : ''}
            ${feature.highlight && variant === 'cards' ? 'ring-2 ring-primary transform scale-105' : ''}
            ${variant !== 'cards' && background === 'gray' ? 'bg-white rounded-lg p-6' : ''}
            h-full flex flex-col
          `}>
            <!-- Icon -->
            <div class={`
              ${variant === 'centered' || variant === 'minimal' ? 'mx-auto' : ''}
              ${variant === 'cards' ? 'bg-primary/10' : ''}
              ${variant === 'centered' ? 'bg-primary/10' : ''}
              ${variant === 'cards' || variant === 'centered' ? 'w-16 h-16 rounded-full flex items-center justify-center' : ''}
              mb-4
            `}>
              {feature.icon ? (
                feature.iconType === 'custom' ? (
                  <div class={`${iconColor} ${variant === 'cards' || variant === 'centered' ? 'w-8 h-8' : 'w-10 h-10'}`} set:html={feature.icon}></div>
                ) : (
                  <svg 
                    class={`${iconColor} ${variant === 'cards' || variant === 'centered' ? 'w-8 h-8' : 'w-10 h-10'}`} 
                    fill="none" 
                    stroke="currentColor" 
                    viewBox="0 0 24 24"
                  >
                    <path 
                      stroke-linecap="round" 
                      stroke-linejoin="round" 
                      stroke-width="2" 
                      d={feature.icon}
                    />
                  </svg>
                )
              ) : (
                <svg 
                  class={`${iconColor} ${variant === 'cards' || variant === 'centered' ? 'w-8 h-8' : 'w-10 h-10'}`} 
                  fill="none" 
                  stroke="currentColor" 
                  viewBox="0 0 24 24"
                >
                  <path 
                    stroke-linecap="round" 
                    stroke-linejoin="round" 
                    stroke-width="2" 
                    d={defaultIcons[index % defaultIcons.length]}
                  />
                </svg>
              )}
            </div>
            
            <!-- Content -->
            <div class="flex-grow">
              <h3 class={`text-xl font-bold mb-2 ${
                background === 'primary' && variant !== 'cards' ? 'text-white' : 'text-gray-900'
              }`}>
                {feature.title}
              </h3>
              <p class={`${
                background === 'primary' && variant !== 'cards' ? 'text-white/90' : 'text-gray-600'
              } ${variant === 'minimal' ? 'text-sm' : ''}`}>
                {feature.description}
              </p>
            </div>
            
            {feature.highlight && variant === 'cards' && (
              <div class="mt-4 pt-4 border-t border-gray-200">
                <span class="text-primary font-semibold text-sm flex items-center gap-1">
                  <svg class="w-4 h-4" fill="currentColor" viewBox="0 0 20 20">
                    <path d="M9.049 2.927c.3-.921 1.603-.921 1.902 0l1.07 3.292a1 1 0 00.95.69h3.462c.969 0 1.371 1.24.588 1.81l-2.8 2.034a1 1 0 00-.364 1.118l1.07 3.292c.3.921-.755 1.688-1.54 1.118l-2.8-2.034a1 1 0 00-1.175 0l-2.8 2.034c-.784.57-1.838-.197-1.539-1.118l1.07-3.292a1 1 0 00-.364-1.118L2.98 8.72c-.783-.57-.38-1.81.588-1.81h3.461a1 1 0 00.951-.69l1.07-3.292z"/>
                  </svg>
                  Recommended
                </span>
              </div>
            )}
          </div>
        </ScrollAnimation>
      ))}
    </div>
  </div>
</section>

<style>
  /* Add any component-specific styles here */
</style>